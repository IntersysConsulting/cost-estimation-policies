import "tfrun"
import "tfplan"

workspace_name = tfrun.workspace.name
desired_cpu_count = 1

print("Checking to make sure the", workspace_name, "workspace is using ", desired_cpu_count, "cpu")

configured_cpu_count = tfplan.module([]).resources.module.vsphere-emptyVM[0].vsphere_virtual_machine.new_vm.values.num_cpus

print(workspace_name, "workspace is requesting ", desired_cpu_count, "cpu")

main = rule {
    desired_cpu_count == configured_cpu_count
}
